@startuml
title Detect Connected Devices on Isl Port

participant "Switch A\ninput table " as SWAIT
participant "Switch A\negress table " as SWAE
participant "Switch A\ntransit table  " as SWAT
collections "Floodlights " as FL
control "kilda.floodlight.\nconnected.devices.priv  " as TP
participant "ConnectedDevicesTopology    " as CDT
database DB

activate SWAIT
SWAIT -> SWAIT : Mark LLDP\npacket by\nmetadata
SWAIT -> SWAE: Send to egress
deactivate SWAIT
activate SWAE
SWAE-> SWAT : Send to transit
deactivate SWAE
activate SWAT
SWAT -> FL : LLDP packet\n(match by metadata)
deactivate SWAT
activate FL
FL -> TP : SwitchLldpInfoData
deactivate FL
TP -> CDT : SwitchLldpInfoData
activate CDT
CDT -> DB : Save/update\nConnected Device
deactivate CDT

@enduml
